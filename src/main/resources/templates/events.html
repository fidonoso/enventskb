<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <!--Mis estilos en css/-->
    <link rel="stylesheet" href="/css/global.css" />
    <link rel="stylesheet" href="/css/events.css" />
    <title>Events</title>
</head>
<body class="gradient-custom">
  <!--Navbar--> 
  <div th:insert="~{navbar/navbar :: navbar}"></div>

    <div class="container ">
        <!-- <div> -->
            <!-- <a class="btn btn-outline-success mb-2 text-end" th:href="@{/events/new}">Nuevo Evento</a> -->
            <div class="p-3">

              <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
                Crear nuevo evento
              </button>
            </div>
          
            <section class="text-center" id="panel_events">

                <div th:each="event : ${events}" class="event-card">
                    <div class="card" >
                        <h5 class="card-header text-center" th:text="${event.title}">Card title</h5>
                        <div class="card-body">
                            <div class="d-flex align-items-center">
                                <i class="fa-regular fa-calendar-check me-3 p-0"></i>
                                <h5 class="card-title p-0 mb-0" th:text="${#temporals.format(event.dateTime, 'dd-MMM-yyyy')}">Card title</h5>
                            </div>
                            <div class="d-flex align-items-center">
                                <i class="fa-solid fa-location-dot me-3 p-0"></i>
                                <h6 class="card-subtitle mb-2 text-body-secondary p-0 mb-0" th:text="${event.location}">location</h6>
                            </div>
                            <div class="description-card">
                                <p class="card-text" th:text="${event.description}">Descripcion</p>

                            </div>
                            <div class="d-flex justify-content-evenly py-2" th:if="${event.user.id == user.id}">
    
                                <button class="btn btn-outline-info" 
                                th:data-event-id="${event.id}"  
                                th:data-user-id="${event.user.id}" 
                                th:data-user-logued_id="${user.id}" 
                                onclick="handleEventClick(event)" ><i class="fa-solid fa-pen-to-square"></i></button>
    
                                <button class="btn btn-outline-danger"
                                th:data-event-id="${event.id}"  
                                th:data-user-id="${event.user.id}" 
                                th:data-user-logued_id="${user.id}" 
                                onclick="handleDeleteEventClick(event)"
                                ><i class="fa-solid fa-trash-can"></i></button>
                            </div>
                            <div class="d-flex justify-content-center py-2" th:unless="${event.user.id == user.id}">
                                <button class="btn btn-outline-info"
                                th:data-event-id="${event.id}"  
                                th:data-user-id="${event.user.id}" 
                                th:data-user-logued_id="${user.id}" 
                                onclick="handleRequestParticipation(event)"
                                ><i class="fa-solid fa-hand-point-up me-2"></i>Solicitar participar</button>
    
                            </div>

                            <blockquote class="blockquote mb-0 mt-4">
                                
                                <footer class="blockquote-footer">Creado por <cite title="Source Title" th:text="${event.user.name + ' ' + event.user.last_name}">Source Title</cite></footer>
                            </blockquote>
                        </div>
                    </div>
                </div>
            </section>
        <!-- </div> -->
    </div>

      <!--Modal new events--> 
  <div th:insert="~{events/newEvent :: new_events}"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <!--fontawesome-->
    <script src="https://kit.fontawesome.com/000f4fc413.js" crossorigin="anonymous"></script>

    <!--Mi script-->
<script src="/js/events.js"></script>

</body>
</html>